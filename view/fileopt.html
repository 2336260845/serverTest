<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>上传图片</title>
    <script type="text/javascript">
        var xhr
        function UpFile() {
            var file = document.getElementById("file").files[0];
            var url = "http://127.0.0.1:3333" + "/fileop/push";

            var form = new FormData;
            form.append("file", file);

            xhr = new XMLHttpRequest();
            xhr.open("post", url, true);
            xhr.onload = UpComplete;
            xhr.onerror = UpFailed;

            //TODO 进度条

            xhr.send(form);
        }

        function UpComplete(evt) {
            var data = JSON.parse(evt.target.responseText);
            if (data.success) {
                alert("上传成功");
            } else {
                alert("上传失败");
            }
        }

        function UpFailed(evt) {
            alert("上传失败");
        }

        function CancleUpFile() {
            xhr.abort();
        }
    </script>
</head>
<body>
<progress id="progressBar" value="0" max="100" style="width: 300px;"></progress>
<span id="percentage"></span><span id="time"></span>
<br /><br />
<input type="file" id="file" name="myFile" />
<input type="button" onclick="UpFile()" value="上传文件" />
<input type="button" onclick="CancleUpFile()" value="取消" />
</body>
</html>
